简化版Word数字千位分隔符宏使用指南

此宏用于将Word文档中选中的数字转换为带千位分隔符的格式，例如将"1234567.89"转换为"1,234,567.89"。

功能特点：
- 将选中文本中的数字转换为带千位分隔符的格式
- 自动排除年份格式（如"2025年"、"2,025.年"）
- 自动排除百分比符号（%）附近的数字
- 只对4位及以上的数字添加千位分隔符
- 防止整行选择时出现换行问题

安装步骤：
1. 打开Microsoft Word
2. 按Alt+F11打开VBA编辑器
3. 在VBA编辑器中，点击菜单栏的"文件" → "导入文件"
4. 选择"WordNumberFormatMacro.bas"文件导入
5. 关闭VBA编辑器，返回Word

使用方法：
1. 在Word文档中选中包含数字的文本
2. 按快捷键运行宏（见下文设置快捷键方法）
   或者：点击"开发工具"选项卡 → "宏" → 选择"ConvertSelectedTextToThousands" → 点击"运行"

设置快捷键方法：
方法 1：通过 Word 的"自定义功能区 / 快捷键"来设置
1. 打开 Word，点击 文件 → 选项 → 自定义功能区
2. 点击右下角的 自定义 按钮（在 "键盘快捷方式" 旁）
3. 在弹出的 自定义键盘 窗口中：
   - "类别"选择 宏
   - 在右边的"宏名"中找到你的宏（例如 ConvertSelectedTextToThousands）
   - 将光标放到 请按新快捷键 框中，按下你想用的快捷键（比如 Ctrl + Alt + T）
   - 点击 分配，然后 关闭
4. 现在你就可以直接用快捷键运行宏了。

方法 2：通过"快速访问工具栏"添加宏按钮
1. 点击Word窗口右上角的"快速访问工具栏"下拉箭头
2. 选择"其他命令"
3. 在"从下列位置选择命令"下拉列表中选择"宏"
4. 选择"ConvertSelectedTextToThousands"宏
5. 点击"添加"按钮，然后点击"确定"
6. 现在你可以在快速访问工具栏中点击按钮运行宏

注意事项：
- 宏只会格式化4位及以上的数字，例如"1234"会变成"1,234"，但"123"保持不变
- 年份格式（如"2025年"、"2,025.年"）不会被格式化
- 百分比符号（%）附近的数字不会被格式化
- 整行选择时不会触发换行问题
- 如果在表格中使用宏，可能会出现意外结果，建议避免在表格中使用
- 使用宏前建议先备份文档

示例：
原文：今年收入总额为1234567.89，其中2025年收入为1000000，利润率15%。
格式化后：今年收入总额为1,234,567.89，其中2025年收入为1,000,000.00，利润率15%。

小数格式化说明：
- 整数会自动添加".00"后缀，例如：总收入8123456 → 总收入8,123,456.00
- 原有小数保持精度不变，例如：金额为1234567.89 → 金额为1,234,567.89
- 更多示例：
原文：总收入8123456，支出为5432109，利润率为12.345%
格式化后：总收入8,123,456.00，支出为5,432,109.00，利润率为12.345%
（整数会自动添加".00"后缀，小数保持原有精度，百分比数据不受影响）

故障排除：
- 如果宏无法运行，请确保已启用宏功能
- 如果找不到宏，请检查是否正确导入了.bas文件
- 如果格式化结果不正确，请检查选中的文本是否包含特殊格式字符
